<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DealsPoint Import & Partner Expenses</title>

  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 min-h-screen py-10">

  <div class="max-w-2xl mx-auto bg-white shadow-md rounded-lg p-8">
    <h2 class="text-2xl font-bold mb-6 text-center text-blue-700">
      DealsPoint Import & Partner Expenses
    </h2>

    <form id="expenseForm" class="space-y-4">

      <div>
        <label class="font-semibold">Date</label>
        <input type="date" name="date" required class="w-full border p-2 rounded">
      </div>

      <div>
        <label class="font-semibold">Partner Name</label>
        <input type="text" name="partner" required class="w-full border p-2 rounded" placeholder="Example: Asif, Nayan, etc">
      </div>

      <div>
        <label class="font-semibold">Expense Title</label>
        <input type="text" name="title" required class="w-full border p-2 rounded" placeholder="Example: Product Purchase">
      </div>

      <div>
        <label class="font-semibold">Expense Category</label>
        <select name="category" required class="w-full border p-2 rounded">
          <option value="">Select Category</option>

          <option>Product Buying Cost (China)</option>
          <option>Supplier Payment</option>
          <option>Product Shipping Cost</option>
          <option>Customs / Tax</option>
          <option>Delivery to BD Warehouse</option>
          <option>China Agent Cost</option>

          <option>Marketing</option>
          <option>Office Expense</option>
          <option>Tools / Software</option>
          <option>Business Expense</option>
          <option>Partner Expense</option>

          <option>Other</option>
        </select>
      </div>

      <div>
        <label class="font-semibold">Amount</label>
        <input type="number" name="amount" required class="w-full border p-2 rounded" placeholder="5000">
      </div>

      <div>
        <label class="font-semibold">Description (optional)</label>
        <textarea name="description" class="w-full border p-2 rounded" placeholder="Example: Supplier paid, shipping Shenzhen â†’ Dhaka"></textarea>
      </div>

      <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700">
        Save Expense
      </button>

    </form>

    <!-- Success Message -->
    <p id="successMsg" class="text-green-600 font-semibold mt-5 hidden text-center">
      Expense saved successfully!
    </p>

    <!-- Error Message -->
    <p id="errorMsg" class="text-red-600 font-semibold mt-5 hidden text-center"></p>

  </div>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbySpvLAYWmFzyYlucv3GNKyBgwQawEtuQ06wgUFEhZ31g24H7ZjkWYEn_weURC99_20/exec";

    document.getElementById("expenseForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      const formData = new FormData(e.target);

      try {
        const res = await fetch(scriptURL, {
          method: "POST",
          mode: "cors",
          body: formData,
        });

        let data;

        // Sometimes GAS returns plain text, so we catch JSON errors
        try {
          data = await res.json();
        } catch (jsonError) {
          data = { success: true }; // treat as success if backend responded without JSON
        }

        if (data.success) {
          document.getElementById("successMsg").classList.remove("hidden");
          document.getElementById("errorMsg").classList.add("hidden");
          document.getElementById("errorMsg").innerText = "";
          e.target.reset();
        } else {
          document.getElementById("successMsg").classList.add("hidden");
          document.getElementById("errorMsg").classList.remove("hidden");
          document.getElementById("errorMsg").innerText = data.error || "Something went wrong";
        }

      } catch (err) {
        document.getElementById("successMsg").classList.add("hidden");
        document.getElementById("errorMsg").classList.remove("hidden");
        document.getElementById("successMsg").innerText = "Submit Success";
      }
    });
  </script>

</body>
</html>

